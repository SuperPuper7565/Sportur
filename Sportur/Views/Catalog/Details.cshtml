@using System.Text.Json
@model BicycleDetailsViewModel

@{
    var variantsJson = JsonSerializer.Serialize(Model.Variants, new JsonSerializerOptions
    {
        PropertyNamingPolicy = JsonNamingPolicy.CamelCase
    });
}

<h2>@Model.Brand @Model.ModelName</h2>
<p class="text-muted">@Model.Category</p>

<div class="row mt-3" id="catalogDetails" data-variants="@variantsJson">

    <!-- Фото -->
    <div class="col-md-6">
        <img id="bikeImage"
             src="@Model.Colors.FirstOrDefault()?.PhotoUrl"
             class="img-fluid"
             alt="Фото велосипеда" />
    </div>

    <!-- Выбор -->
    <div class="col-md-6">

        <!-- Цвет -->
        <h4>Цвет</h4>
        <div id="colors">
            @foreach (var color in Model.Colors)
            {
                <button type="button"
                        class="btn btn-outline-secondary me-2 mb-2 color-btn"
                        data-color-id="@color.Id"
                        data-photo="@color.PhotoUrl">
                    @color.Color
                </button>
            }
        </div>


        <!-- Ростовка -->
        <h4 class="mt-3">Ростовка</h4>

        <select id="sizeSelect" class="form-select">
            <option value="">Выберите размер</option>
            @foreach (var size in Model.Sizes)
            {
                <option value="@size.Id">@size.FrameSize</option>
            }
        </select>


        <!-- Цена -->
        <h3 class="mt-3">
            Цена: <span id="price">—</span> ₽
        </h3>

        <!-- Остаток -->
        <p id="stock" class="text-muted"></p>

        <!-- Корзина -->
        <form asp-controller="Cart"
              asp-action="Add"
              method="post">

            <input type="hidden" name="variantId" id="variantId" />

            <button type="submit"
                    id="addToCartBtn"
                    class="btn btn-success"
                    disabled>
                В корзину
            </button>
        </form>

    </div>
</div>

